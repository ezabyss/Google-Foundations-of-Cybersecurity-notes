# üö® Suricata IDS Lab ‚Äì Alerting, Rules, and Log Analysis

## üß™ Activity Overview
In this lab, you will explore **Suricata**, an open-source **Intrusion Detection System (IDS)**, **Intrusion Prevention System (IPS)**, and **network analysis tool**.

The focus of this activity is to:
- Understand the structure of Suricata rules (signatures)
- Trigger alerts using custom rules
- Analyze Suricata log outputs (`fast.log` and `eve.json`)
- Extract meaningful security insights from network traffic

This lab simulates a **real-world SOC scenario**, where a security analyst monitors network traffic and investigates alerts.

> **Note:** The terms *rules* and *signatures* are used interchangeably.

---

## üéØ Learning Objectives
By completing this lab, you will be able to:
- Examine and understand Suricata rule syntax
- Trigger IDS alerts using packet capture files
- Interpret Suricata alert logs
- Analyze structured JSON logs using `jq`
- Correlate network events using `flow_id`

---

## üß† Scenario
You are a **security analyst** responsible for monitoring traffic on your organization‚Äôs network.

Your tasks include:
1. Reviewing existing Suricata rules
2. Running Suricata against captured traffic
3. Investigating alerts generated by the IDS
4. Analyzing detailed event logs for deeper insights

---

## üõ†Ô∏è Lab Environment
- User: `analyst`
- Shell: Bash
- Tool: Suricata
- Log Directory: `/var/log/suricata`
- Input Files:
  - `sample.pcap`
  - `custom.rules`

---

## üìÇ Files Used in This Lab

### `sample.pcap`
A packet capture file containing simulated network traffic used to test Suricata rules.

### `custom.rules`
A file containing custom Suricata rules used to detect specific traffic patterns.

### `fast.log`
- Quick alert log
- Shows a summarized view of triggered alerts
- Considered **deprecated** but useful for fast validation

### `eve.json`
- Primary Suricata log file
- JSON-formatted
- Contains detailed alert and network telemetry data
- Ideal for incident response and threat hunting

---

## üß© Task 1: Examine a Custom Suricata Rule

Display the contents of the rules file:
- `cat custom.rules`

### Example Rule
```
alert http $HOME_NET any -> $EXTERNAL_NET any (
  msg:"GET on wire";
  flow:established,to_server;
  content:"GET";
  http_method;
  sid:12345;
  rev:3;
)
```

---

## üß© Task 2: Trigger the Custom Rule

Run Suricata:
- `sudo suricata -r sample.pcap -S custom.rules -k none`

View alerts:
- `cat /var/log/suricata/fast.log`

---

## üß© Task 3: Analyze eve.json Output

Pretty print logs:
- `jq . /var/log/suricata/eve.json | less`

Extract fields:
- `jq -c "[.timestamp,.flow_id,.alert.signature,.proto,.dest_ip]" /var/log/suricata/eve.json`

---

## üß† Key Takeaways
- Suricata rules define how traffic is inspected
- Packet captures simulate real traffic
- `fast.log` is for quick checks
- `eve.json` is used for deep analysis
- `flow_id` correlates related events

---

## ‚úÖ Conclusion
This lab builds foundational SOC skills including rule analysis, alert validation, and structured log investigation.

---

‚úçÔ∏è Notes By Abhishek (Ez Abyss)
